{% paginate collection.products by section.settings.products_per_page %}
<section class="collection-page reveal" data-section="{{ section.id }}">
  
  <div class="collection-header glass-panel">
    <h1 class="collection-title">{{ collection.title }}</h1>
    {% if collection.description != blank %}
      <div class="collection-desc">{{ collection.description }}</div>
    {% endif %}
  </div>

  <div class="collection-container">
    <div class="collection-toolbar">
      <p class="product-count">
        {{ collection.products_count }} {{ 'products.collection.products' | t | default: 'Products' }}
      </p>
      
      <div class="sort-wrapper">
        <select id="sort-by" class="glass-panel sort-select" onchange="location.href = this.value;">
          {% for option in collection.sort_options %}
            <option value="{{ request.path }}?sort_by={{ option.value }}" {% if option.value == collection.sort_by %}selected{% endif %}>
              {{ option.name }}
            </option>
          {% endfor %}
        </select>
      </div>
    </div>

    <div class="elite-grid">
      {% for product in collection.products %}
        {% render 'product-card', product: product %}
      {% else %}
        <p class="no-products">{{ 'products.collection.no_products' | t | default: 'No products found in this collection.' }}</p>
      {% endfor %}
    </div>

    {% if paginate.pages > 1 %}
      <div class="pagination-wrapper">
        <div class="pagination glass-panel">
          {{ paginate | default_pagination: next: '>', previous: '<' }}
        </div>
      </div>
    {% endif %}
  </div>
</section>
{% endpaginate %}

<style>
  .collection-page { padding: 120px 5% 60px; max-width: 1400px; margin: 0 auto; color: #fff; }
  
  .collection-header { 
    padding: 80px 20px; 
    text-align: center; 
    border-radius: 40px; 
    margin-bottom: 60px;
    background: linear-gradient(to bottom, rgba(212, 175, 55, 0.08), rgba(255, 255, 255, 0.02));
    border: 1px solid rgba(255,255,255,0.05);
  }

  .collection-title { font-family: 'Playfair Display', serif; font-size: clamp(2.5rem, 5vw, 4rem); margin-bottom: 20px; color: var(--primary-gold, #D4AF37); text-transform: uppercase; letter-spacing: 3px; }
  .collection-desc { max-width: 700px; margin: 0 auto; opacity: 0.7; line-height: 1.8; font-size: 1.1rem; }

  .collection-toolbar { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    margin-bottom: 40px; 
    padding: 0 15px;
  }

  .product-count { font-size: 0.85rem; letter-spacing: 2px; text-transform: uppercase; opacity: 0.5; font-weight: bold; }

  .sort-select { 
    padding: 12px 25px; 
    border-radius: 50px; 
    color: #fff; 
    background: rgba(255,255,255,0.05); 
    border: 1px solid rgba(255,255,255,0.1); 
    cursor: pointer;
    outline: none;
    font-size: 0.9rem;
    transition: 0.3s;
  }
  .sort-select:hover { border-color: var(--primary-gold, #D4AF37); }
  .sort-select option { background: #111; color: #fff; }

  .elite-grid { 
    display: grid; 
    grid-template-columns: repeat(4, 1fr); 
    gap: 30px; 
  }

  .no-products { text-align: center; padding: 120px 0; font-size: 1.2rem; opacity: 0.4; letter-spacing: 1px; }

  /* Pagination Styling */
  .pagination-wrapper { display: flex; justify-content: center; margin-top: 80px; }
  .pagination { 
    padding: 15px 30px; 
    border-radius: 100px; 
    display: flex; 
    align-items: center;
    gap: 20px; 
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.1);
  }
  .pagination a, .pagination span { color: #fff; text-decoration: none; font-weight: bold; transition: 0.3s; font-size: 0.9rem; }
  .pagination .current { color: var(--primary-gold, #D4AF37); text-shadow: 0 0 10px rgba(212,175,55,0.5); }
  .pagination a:hover { color: var(--primary-gold, #D4AF37); transform: scale(1.1); }

  @media (max-width: 1100px) { .elite-grid { grid-template-columns: repeat(3, 1fr); } }
  @media (max-width: 768px) {
    .elite-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
    .collection-title { font-size: 2.2rem; }
    .collection-toolbar { flex-direction: column; gap: 20px; text-align: center; }
  }
</style>

{% schema %}
{
  "name": "Collection Grid Elite",
  "settings": [
    {
      "type": "range",
      "id": "products_per_page",
      "min": 4,
      "max": 48,
      "step": 4,
      "default": 16,
      "label": "Products per page"
    }
  ],
  "presets": [
    {
      "name": "Collection Grid Elite"
    }
  ]
}
{% endschema %}
