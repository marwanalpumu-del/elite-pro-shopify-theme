<section class="main-product-container reveal" data-section="{{ section.id }}">
  <div class="product-flex-layout">
    
    {% comment %} --- Left Side: Luxury Gallery --- {% endcomment %}
    <div class="product-gallery glass-panel">
      <div class="main-image-holder">
        <img src="{{ product.featured_image | image_url: width: 1200 }}" 
             alt="{{ product.featured_image.alt | escape }}" 
             class="featured-img" 
             id="MainProductImage-{{ section.id }}"
             loading="eager">
      </div>
      
      {% if product.images.size > 1 %}
        <div class="thumbnails-grid" data-cursor-expand>
          {% for image in product.images %}
            <div class="thumb-wrapper {% if forloop.first %}active{% endif %}" 
                 onclick="window.updateProductImage('{{ image | image_url: width: 1200 }}', this, '{{ section.id }}')">
              <img src="{{ image | image_url: width: 200 }}" 
                   class="thumb-img" 
                   loading="lazy"
                   alt="{{ image.alt | escape }}">
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    {% comment %} --- Right Side: Product Details (Dynamic Blocks) --- {% endcomment %}
    <div class="product-info-panel">
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          
          {%- when '@app' -%}
            {% render block %}

          {%- when 'title' -%}
            <nav class="breadcrumb" {{ block.shopify_attributes }}>
              <a href="/">HOME</a> / {{ product.collections.first.title | uppercase }}
            </nav>
            <h1 class="product-main-title">{{ product.title }}</h1>

          {%- when 'price' -%}
            <div class="price-badge gold-glow" id="ProductPrice-{{ section.id }}" {{ block.shopify_attributes }}>
              {{ product.selected_or_first_available_variant.price | money_with_currency }}
            </div>

          {%- when 'description' -%}
            <div class="product-description glass-panel" {{ block.shopify_attributes }}>
              {{ product.description }}
            </div>

          {%- when 'buy_buttons' -%}
            <div {{ block.shopify_attributes }}>
              {% form 'product', product, id: "product-form", class: "elite-product-form" %}
                <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                
                {% unless product.has_only_default_variant %}
                  <div class="product-variants-wrapper">
                    <label class="gold-text-small">SELECT VARIATION</label>
                    <select name="id" class="elite-select glass-panel">
                      {% for variant in product.variants %}
                        <option value="{{ variant.id }}" {% if variant == product.selected_or_first_available_variant %}selected{% endif %}>
                          {{ variant.title }} - {{ variant.price | money }}
                        </option>
                      {% endfor %}
                    </select>
                  </div>
                {% endunless %}
                
                <div class="purchase-actions">
                  <div class="quantity-wrapper glass-panel">
                    <input type="number" name="quantity" value="1" min="1" class="qty-input">
                  </div>

                  <button type="submit" name="add" class="btn-elite buy-now-btn" {% unless product.available %}disabled{% endunless %}>
                    <span>{% if product.available %}ADD TO BAG{% else %}SOLD OUT{% endif %}</span>
                  </button>
                </div>
              {% endform %}
            </div>

        {%- endcase -%}
      {%- endfor -%}
      
      <div class="luxury-trust-badges">
        <p>âœ¨ COMPLIMENTARY SHIPPING</p>
        <p>ðŸ”’ SECURE ENCRYPTED CHECKOUT</p>
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Elite Product Main",
  "tag": "section",
  "blocks": [
    { "type": "@app" },
    { "type": "title", "name": "Title & Breadcrumb", "limit": 1 },
    { "type": "price", "name": "Price", "limit": 1 },
    { "type": "description", "name": "Description", "limit": 1 },
    { "type": "buy_buttons", "name": "Buy Buttons", "limit": 1 }
  ],
  "settings": [
    {
      "type": "header",
      "content": "Visual Options"
    }
  ],
  "presets": [
    {
      "name": "Elite Product Main",
      "blocks": [
        { "type": "title" },
        { "type": "price" },
        { "type": "description" },
        { "type": "buy_buttons" }
      ]
    }
  ]
}
{% endschema %}
